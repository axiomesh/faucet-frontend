import styles from './index.less';
import { Input, Button } from 'antd';
import footImg from '@/assets/logoDark.png';
import CanvasPage from './mask';
import { useState } from 'react';
import { postAddress } from "@/services/home";

const HomePage: React.FC = () => {
  const [show, setShow] = useState(false);
  const [errMsg, setErrMsg] = useState('');
  const [errCode, setErrCode] = useState(0);
  const [val, setVal] = useState('');
  const [hash, setHash] = useState('');

  const handleChangeValue = (e) => {
    setVal(e.target.value);
  }

  const handleAddress = async () => {
    if(!val ){
      setErrMsg('please enter correct address.');
      return
    } else {
      setErrMsg('');
    }
    setShow(true);
    try{
      const res = await postAddress(val);
      setHash(res.txHash);
      if(res.msg !== 'ok') {
        setTimeout(() => {
          setErrMsg(res.msg);
          setShow(false);
        }, 5000)
      } else {
        setErrMsg('');
      }
    } catch (e){
      setErrCode(500);
      // setErrMsg(e)
    }

  }

  const handleCancel = () => {
    setErrCode(0);
    setShow(false)
  }

  const handleGitHub = () => {
    window.open('https://github.com/axiomesh/explorer-frontend')
  }

  return (
    <div className={styles.container}>
      <div className={styles.content}>
        <div className={styles.contentBg}>
            <div className={styles.contentBgIcon}>
              <svg xmlns="http://www.w3.org/2000/svg" width="479" height="480" viewBox="0 0 479 480" fill="none">
                <g style={{mixBlendMode:"overlay"}}>
                  <mask id="path-1-inside-1_1351_29362" fill="white">
                    <path fillRule="evenodd" clipRule="evenodd" d="M330.115 262.238C334.348 241.142 341.287 218.97 358.822 206.499L410.928 169.442C437.708 150.397 475.706 159.655 482.901 191.72C505.66 293.147 461.455 401.815 366.682 456.532C271.883 511.265 155.633 495.189 79.1749 424.716C55.0115 402.444 66.0058 364.911 95.8947 351.252L154.052 324.675C173.622 315.732 196.292 320.817 216.676 327.706C239.599 335.453 265.615 333.674 288.217 320.624C310.81 307.581 325.356 285.952 330.115 262.238ZM272.597 162.539C292.978 169.434 315.645 174.525 335.217 165.589L393.386 139.032C423.279 125.384 434.287 87.8558 410.133 65.5747C333.675 -4.95226 217.385 -21.0536 122.557 33.6952C27.7567 88.4282 -16.4464 197.143 6.358 298.595C13.5648 330.657 51.566 339.902 78.3391 320.847L130.44 283.765C147.969 271.29 154.901 249.118 159.128 228.022C163.881 204.299 178.429 182.66 201.03 169.611C223.641 156.557 249.668 154.781 272.597 162.539Z"/>
                  </mask>
                  <path fillRule="evenodd" clipRule="evenodd" d="M330.115 262.238C334.348 241.142 341.287 218.97 358.822 206.499L410.928 169.442C437.708 150.397 475.706 159.655 482.901 191.72C505.66 293.147 461.455 401.815 366.682 456.532C271.883 511.265 155.633 495.189 79.1749 424.716C55.0115 402.444 66.0058 364.911 95.8947 351.252L154.052 324.675C173.622 315.732 196.292 320.817 216.676 327.706C239.599 335.453 265.615 333.674 288.217 320.624C310.81 307.581 325.356 285.952 330.115 262.238ZM272.597 162.539C292.978 169.434 315.645 174.525 335.217 165.589L393.386 139.032C423.279 125.384 434.287 87.8558 410.133 65.5747C333.675 -4.95226 217.385 -21.0536 122.557 33.6952C27.7567 88.4282 -16.4464 197.143 6.358 298.595C13.5648 330.657 51.566 339.902 78.3391 320.847L130.44 283.765C147.969 271.29 154.901 249.118 159.128 228.022C163.881 204.299 178.429 182.66 201.03 169.611C223.641 156.557 249.668 154.781 272.597 162.539Z" fill="white" fillOpacity="0.2"/>
                  <path d="M130.44 283.765L148.996 309.836L130.44 283.765ZM159.128 228.022L127.751 221.735L159.128 228.022ZM272.597 162.539L262.342 192.851L272.597 162.539ZM79.1749 424.716L57.4872 448.245L79.1749 424.716ZM95.8947 351.252L109.195 380.357L95.8947 351.252ZM393.386 139.032L406.676 168.142L393.386 139.032ZM358.822 206.499L377.368 232.576L358.822 206.499ZM330.115 262.238L298.74 255.943L330.115 262.238ZM410.928 169.442L392.382 143.364L410.928 169.442ZM392.382 143.364L340.276 180.421L377.368 232.576L429.474 195.52L392.382 143.364ZM382.682 484.245C489.92 422.331 539.86 299.407 514.124 184.713L451.677 198.726C471.46 286.887 432.99 381.299 350.682 428.819L382.682 484.245ZM57.4872 448.245C143.946 527.936 275.415 546.176 382.682 484.245L350.682 428.819C268.351 476.353 167.32 462.442 100.863 401.186L57.4872 448.245ZM140.751 295.571L82.5942 322.147L109.195 380.357L167.352 353.78L140.751 295.571ZM272.217 292.912C257.915 301.169 241.499 302.317 226.922 297.39L206.431 358.021C237.699 368.589 273.316 366.178 304.217 348.337L272.217 292.912ZM298.74 255.943C295.714 271.023 286.514 284.658 272.217 292.912L304.217 348.337C335.106 330.504 354.998 300.882 361.489 268.534L298.74 255.943ZM380.096 109.922L321.927 136.48L348.507 194.699L406.676 168.142L380.096 109.922ZM138.557 61.408C220.913 13.8598 321.979 27.7937 388.436 89.0959L431.83 42.0535C345.372 -37.6983 213.856 -55.967 106.557 5.9824L138.557 61.408ZM37.579 291.578C17.7573 203.395 56.2249 108.943 138.557 61.408L106.557 5.9824C-0.71159 67.914 -50.6502 190.891 -24.863 305.613L37.579 291.578ZM111.885 257.694L59.7838 294.776L96.8945 346.918L148.996 309.836L111.885 257.694ZM190.504 234.309C193.527 219.223 202.729 205.581 217.03 197.324L185.03 141.898C154.13 159.738 134.235 189.375 127.751 221.735L190.504 234.309ZM217.03 197.324C231.338 189.064 247.761 187.918 262.342 192.851L282.852 132.226C251.575 121.645 215.944 124.05 185.03 141.898L217.03 197.324ZM148.996 309.836C177.601 289.477 186.233 255.623 190.504 234.309L127.751 221.735C123.568 242.613 118.337 253.102 111.885 257.694L148.996 309.836ZM-24.863 305.613C-18.4725 334.043 2.20456 352.781 26.2013 359.653C49.5235 366.332 75.7581 361.961 96.8945 346.918L59.7838 294.776C54.1471 298.788 47.9945 299.322 43.8211 298.127C41.8323 297.557 40.5197 296.678 39.6941 295.838C38.9527 295.084 38.0926 293.863 37.579 291.578L-24.863 305.613ZM321.927 136.48C314.722 139.769 303.023 139.05 282.852 132.226L262.342 192.851C282.934 199.817 316.567 209.281 348.507 194.699L321.927 136.48ZM167.352 353.78C174.556 350.488 186.257 351.203 206.431 358.021L226.922 297.39C206.326 290.43 172.688 280.976 140.751 295.571L167.352 353.78ZM100.863 401.186C99.1405 399.599 98.5125 398.243 98.2304 397.224C97.9162 396.09 97.8109 394.513 98.3121 392.506C99.3637 388.294 102.902 383.233 109.195 380.357L82.5942 322.147C58.998 332.93 42.0952 353.465 36.2183 377.002C30.1715 401.22 36.0609 428.496 57.4872 448.245L100.863 401.186ZM406.676 168.142C430.276 157.367 447.186 136.839 453.071 113.304C459.127 89.0886 453.248 61.8107 431.83 42.0535L388.436 89.0959C390.157 90.684 390.785 92.0399 391.067 93.0591C391.38 94.1939 391.485 95.7705 390.983 97.7775C389.93 101.989 386.389 107.049 380.096 109.922L406.676 168.142ZM340.276 180.421C311.661 200.772 303.017 234.628 298.74 255.943L361.489 268.534C365.679 247.656 370.914 237.167 377.368 232.576L340.276 180.421ZM429.474 195.52C435.112 191.51 441.265 190.978 445.438 192.175C447.426 192.745 448.738 193.625 449.564 194.465C450.305 195.219 451.164 196.441 451.677 198.726L514.124 184.713C507.744 156.281 487.074 137.535 463.08 130.654C439.76 123.967 413.523 128.329 392.382 143.364L429.474 195.52Z" fill="white" fillOpacity="0.15" mask="url(#path-1-inside-1_1351_29362)"/>
                </g>
              </svg>
            </div>
            <div className={styles.contentTitle}>
              <div className={styles.miniTitle}>AXM faucet</div>
              <div className={styles.minTitle}>Axiomesh AXM faucet</div>
              <div className={styles.subTitle}>
                <div>fill your address below and get 0.5 test AXM for free</div>
              </div>
              <div className={styles.inputBox}>
                <Input onChange={handleChangeValue} placeholder="Address" className={styles.input} />
              </div>
              <div className={styles.btnBox}>
                {errMsg ==='The address already has enough test tokens' || errMsg === 'The address has recently received test tokens' ?<Button
                  disabled
                  className={styles.disabledBtn}
                >{errMsg}</Button> :
                  <Button onClick={handleAddress} className={styles.btn}>Request for 0.5BXH</Button>}
              </div>
              {errMsg ? <div className={styles.errorBox}>
                <div className={styles.errorText}>
                  {errMsg}
                </div>
              </div> : null}
            </div>
        </div>

      </div>
      <div className={styles.footer}>
        <div className={styles.first}>
          <img src={footImg} width={234} alt='' />
          <div style={{display: 'flex'}}>
            <div className={styles.icon}>
              <svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                 <path d="M12.5332 26C9.76035 26 7.17558 25.2227 5 23.8816C6.84714 23.9968 10.1069 23.7209 12.1345 21.857C9.08435 21.7221 7.7088 19.4675 7.52938 18.5041C7.78854 18.6004 9.02454 18.716 9.72229 18.4462C6.21363 17.5984 5.67537 14.6308 5.79498 13.7252C6.45285 14.1684 7.56925 14.3225 8.00783 14.284C4.73839 12.0294 5.91459 8.63793 6.49273 7.90568C8.83899 11.0385 12.3553 12.7979 16.7055 12.8958C16.6234 12.5491 16.5801 12.1882 16.5801 11.8174C16.5801 9.15684 18.8115 7 21.564 7C23.0022 7 24.2981 7.5888 25.2077 8.53061C26.1688 8.31357 27.6151 7.80549 28.3222 7.36613C27.9658 8.59939 26.8562 9.62819 26.1851 10.0095C26.1796 9.99647 26.1906 10.0225 26.1851 10.0095C26.7746 9.92355 28.3698 9.62809 29 9.21602C28.6884 9.90886 27.512 11.0608 26.5466 11.7057C26.7262 19.3401 20.6656 26 12.5332 26Z" fill="currentColor"/>
              </svg>
              <span>Twitter</span>
            </div>
            <a target="_blank" href='https://github.com/axiomesh/explorer-frontend'  style={{marginLeft: 28}} className={styles.icon}>
              <svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M15.8871 4.26666C9.2595 4.26666 3.88525 9.63996 3.88525 16.2685C3.88525 21.5713 7.32413 26.07 12.0928 27.657C12.6926 27.7681 12.9129 27.3967 12.9129 27.0796C12.9129 26.7935 12.9017 25.848 12.8966 24.8451C9.5576 25.5711 8.85305 23.4291 8.85305 23.4291C8.30711 22.0418 7.52048 21.673 7.52048 21.673C6.43161 20.9281 7.60256 20.9433 7.60256 20.9433C8.80778 21.0281 9.44239 22.1802 9.44239 22.1802C10.5128 24.015 12.25 23.4845 12.9349 23.1779C13.0426 22.4021 13.3537 21.8728 13.6969 21.5731C11.0312 21.2695 8.2288 20.2404 8.2288 15.6417C8.2288 14.3314 8.69765 13.2607 9.46545 12.4202C9.34082 12.1179 8.93005 10.8972 9.5817 9.24406C9.5817 9.24406 10.5895 8.92148 12.8831 10.4743C13.8403 10.2083 14.8671 10.075 15.8871 10.0705C16.907 10.075 17.9345 10.2083 18.8937 10.4743C21.1845 8.92148 22.1909 9.24406 22.1909 9.24406C22.8442 10.8972 22.4332 12.1179 22.3086 12.4202C23.0781 13.2607 23.5437 14.3313 23.5437 15.6417C23.5437 20.2513 20.7361 21.2664 18.0636 21.5635C18.494 21.9359 18.8776 22.6664 18.8776 23.786C18.8776 25.3918 18.8637 26.6843 18.8637 27.0796C18.8637 27.399 19.0797 27.7733 19.6881 27.6554C24.4542 26.0666 27.8888 21.5695 27.8888 16.2685C27.8888 9.63996 22.5153 4.26666 15.8871 4.26666Z" fill="currentColor"/>
              </svg>
              <span>Github</span>
            </a>
          </div>
        </div>
        <div style={{color: '#CBD5E0'}}>Axiomesh All rights reserved</div>
      </div>
      {
        show ? <CanvasPage errorCode={errCode} hash={hash} onCancel={handleCancel} /> : null
      }
    </div>
  );
};

export default HomePage;
